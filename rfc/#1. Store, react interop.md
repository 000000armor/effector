# Effector RFC #1. Store, react interop

- Stores for application should be as lightweight as possible.
- Stores should be freely composable

## Example

**Part I. Definitions**

```javascript
//@flow event.js
import {
 createEvent,
 type Event,
} from 'effector'

export const inputText: Event<string> = createEvent('input text')
export const click: Event<void> = createEvent('click')
export const resetForm: Event<void> = createEvent('reset')
export const increment: Event<void> = createEvent('increment')
```

```javascript
//@flow store.js
import {createStore} from 'effector'

export const counter = createStore(0)
export const text = createStore('')
export const store = createStore({counter, text})
```


```javascript
//@flow effect.js
import {createEffect, type Effect} from 'effector'

export const fetchSavedText: Effect<string> = createEffect('fetch saved text')
```

**Part II. Implementations, busines logic, mocks etc.;**

```javascript
//@flow effect-fallback.js
import {fetchSavedText} from './effect'

fetchSavedText.use(() =>
 Promise.resolve('~~ mock for saved text ~~')
)
```

```javascript
//@flow state.js
import {counter, text} from './store'
import {click, inputText, fetchSavedText, increment, resetForm} from './event'

counter
 .reset(resetForm)
text
 .reset(resetForm)

inputText
 .map(text => text.trim())
 .epic(text$ => text$.debounce(500))
 .to(text)

increment
 .to(counter, state => state + 1)

click
 .epic(click$ => click$.throttle(500))
 .watch(async () => {
  await new Promise(_ => setTimeout(_, 500))
  increment()
 })

fetchSavedText.done.to(inputText)
```

**Part III. Components**

```javascript
//@flow atom.js
import * as React from 'react'
import {store} from './store'

export const ClickedTimes = store
 .map(({counter}) => 'Clicked: ' + counter + ' times')
 .map(text => <span>{text}</span>)

export const CurrentText = store
 .withProps(({text}, props) => (
  <p>
   {props.prefix} {text}
  </p>
 ))
```

```javascript
//@flow page.js
import * as React from 'react'
import {ClickedTimes, CurrentText} from './atom.js'

const App = () =>
 <>
  <ClickedTimes/>
  <CurrentText prefix="Current text: "/>
 <>
```

**Part IV. Root**

```javascript
//@flow index.js
import * as React from 'react'
import {App} from './page'
import './state'
import './effect-fallback.js'

export default () => <App/>
```
